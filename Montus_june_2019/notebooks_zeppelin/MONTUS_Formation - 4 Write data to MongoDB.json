{"paragraphs":[{"text":"%md\nIn this notebook, we will try to write wine.csv to MongoDB to create the widgets after in Hupi-Front.","user":"anonymous","dateUpdated":"2019-06-14T09:30:59+0000","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"results":{},"enabled":true,"editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>In this notebook, we will try to write wine.csv to MongoDB to create the widgets after in Hupi-Front.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1560504532576_-2144335727","id":"20190613-154425_1415820730","dateCreated":"2019-06-14T09:28:52+0000","dateStarted":"2019-06-14T09:30:59+0000","dateFinished":"2019-06-14T09:30:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:20644"},{"text":"%md\n# Import libraries","user":"anonymous","dateUpdated":"2019-06-14T09:28:52+0000","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Import libraries</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1560504532577_-1289568969","id":"20190611-120411_178188615","dateCreated":"2019-06-14T09:28:52+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20645"},{"text":"%spark.dep\nz.load(\"/opt/hupi/DATA/mongo-spark-connector_2.11-2.2.0.jar\")\nz.load(\"/opt/hupi/DATA/mongo-java-driver-3.6.0.jar\")\nz.load(\"/opt/hupi/DATA/bson-3.4.1.jar\")","user":"anonymous","dateUpdated":"2019-06-14T13:41:01+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res0: org.apache.zeppelin.dep.Dependency = org.apache.zeppelin.dep.Dependency@f728e47\n"}]},"apps":[],"jobName":"paragraph_1560504532577_1184895096","id":"20190611-123627_339348215","dateCreated":"2019-06-14T09:28:52+0000","dateStarted":"2019-06-14T12:25:47+0000","dateFinished":"2019-06-14T12:25:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20646"},{"text":"import com.mongodb.spark._\nimport com.mongodb.spark.sql._\nimport com.mongodb.spark.config._\nimport org.bson._","user":"anonymous","dateUpdated":"2019-06-14T13:15:20+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"<console>:23: error: object mongodb is not a member of package com\n       import com.mongodb.spark._\n                  ^\n<console>:24: error: object mongodb is not a member of package com\n       import com.mongodb.spark.sql._\n                  ^\n<console>:25: error: object mongodb is not a member of package com\n       import com.mongodb.spark.config._\n                  ^\n<console>:26: error: object bson is not a member of package org\n       import org.bson._\n                  ^\n"}]},"apps":[],"jobName":"paragraph_1560504786580_-1623450164","id":"20190614-093306_1161595589","dateCreated":"2019-06-14T09:33:06+0000","dateStarted":"2019-06-14T13:15:20+0000","dateFinished":"2019-06-14T13:15:24+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:20647"},{"text":"%md\n# Parameters","user":"anonymous","dateUpdated":"2019-06-14T09:28:52+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Parameters</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1560504532577_-884391892","id":"20190613-132104_1803223495","dateCreated":"2019-06-14T09:28:52+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20648"},{"text":"val HdfsUrl = \"hdfs://hupi-factory-02-01-01.factory02.viet.cloud-torus.com:8020/\"\nval dataRepo = \"user/factory02/formation_hupi/wine.csv\"","user":"anonymous","dateUpdated":"2019-06-14T12:29:42+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"HdfsUrl: String = hdfs://hupi-factory-02-01-01.factory02.viet.cloud-torus.com:8020/\ndataRepo: String = user/factory02/formation_hupi/wine.csv\n"}]},"apps":[],"jobName":"paragraph_1560504532577_-1364766259","id":"20190613-132152_667110088","dateCreated":"2019-06-14T09:28:52+0000","dateStarted":"2019-06-14T12:29:42+0000","dateFinished":"2019-06-14T12:29:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20649"},{"text":"val customer = \"factory02\"\r\nval mongoUrl = \"mongodb://@10.101.2.7,10.101.2.8,10.101.2.9\"\r\nval collection = \"agur_iot_messages\"","user":"anonymous","dateUpdated":"2019-06-14T12:29:37+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560504800661_1054728619","id":"20190614-093320_588633918","dateCreated":"2019-06-14T09:33:20+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:20650"},{"text":"%md\n# Load data from HDFS\n\nHere, we use dataset wine.csv that contains chemical analysis of wines grown in the same region in Italy but derived from two different cultivars. This is a sample from dataset wine.data from UCI https://archive.ics.uci.edu/ml/datasets/wine","user":"anonymous","dateUpdated":"2019-06-14T09:28:52+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Load data from HDFS</h1>\n<p>Here, we use dataset wine.csv that contains chemical analysis of wines grown in the same region in Italy but derived from two different cultivars. This is a sample from dataset wine.data from UCI <a href=\"https://archive.ics.uci.edu/ml/datasets/wine\">https://archive.ics.uci.edu/ml/datasets/wine</a></p>\n</div>"}]},"apps":[],"jobName":"paragraph_1560504532578_-1398553105","id":"20190611-123710_1870998178","dateCreated":"2019-06-14T09:28:52+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20651"},{"text":"// Load and parse the data\nval data = spark.read.format(\"csv\").option(\"header\", \"false\").load(HdfsUrl + dataRepo)","user":"anonymous","dateUpdated":"2019-06-14T12:29:46+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"data: org.apache.spark.sql.DataFrame = [_c0: string, _c1: string ... 12 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=0"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1560504532578_1169417828","id":"20190611-124117_1509176682","dateCreated":"2019-06-14T09:28:52+0000","dateStarted":"2019-06-14T12:29:46+0000","dateFinished":"2019-06-14T12:29:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20652"},{"text":"data.count()","user":"anonymous","dateUpdated":"2019-06-14T12:29:48+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res1: Long = 130\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=1"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1560504532579_-537615506","id":"20190612-074817_885713612","dateCreated":"2019-06-14T09:28:52+0000","dateStarted":"2019-06-14T12:29:48+0000","dateFinished":"2019-06-14T12:29:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20653"},{"text":"%md\n# Write data to MongoDB","user":"anonymous","dateUpdated":"2019-06-14T12:22:00+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Write data to MongoDB</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1560504532579_1441506804","id":"20190611-124400_1072583055","dateCreated":"2019-06-14T09:28:52+0000","dateStarted":"2019-06-14T12:22:00+0000","dateFinished":"2019-06-14T12:22:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20654"},{"text":"data_complete.write\r\n    .format(\"com.mongodb.spark.sql\")\r\n    .option(\"uri\", s\"$mongoUrl/$customer.agur_188_indicateurs_periodiques\")\r\n    .mode(\"overwrite\") // à mettre append après\r\n    .save()  ","user":"anonymous","dateUpdated":"2019-06-14T12:23:08+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560504532583_1353679958","id":"20190613-133936_388514160","dateCreated":"2019-06-14T09:28:52+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:20655"}],"name":"MONTUS/Formation - 4 Write data to MongoDB","id":"2EEZPNKBV","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}