{"paragraphs":[{"text":"%md\nIn this notebook, we will try to write wine.csv to MongoDB to create the widgets after in Hupi-Front.","user":"anonymous","dateUpdated":"2019-06-17T19:46:42+0000","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"results":{},"enabled":true,"editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>In this notebook, we will try to write wine.csv to MongoDB to create the widgets after in Hupi-Front.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1560504532576_-2144335727","id":"20190613-154425_1415820730","dateCreated":"2019-06-14T09:28:52+0000","dateStarted":"2019-06-17T19:46:42+0000","dateFinished":"2019-06-17T19:46:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:22764"},{"text":"%md\n# Import libraries","user":"anonymous","dateUpdated":"2019-06-17T19:46:42+0000","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Import libraries</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1560504532577_-1289568969","id":"20190611-120411_178188615","dateCreated":"2019-06-14T09:28:52+0000","dateStarted":"2019-06-17T19:46:42+0000","dateFinished":"2019-06-17T19:46:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:22765"},{"text":"%spark.dep\nz.load(\"/opt/hupi/JAR/mongo-java-driver-3.6.0.jar\")\nz.load(\"/opt/hupi/JAR/mongo-spark-connector_2.11-2.2.0.jar\")\nz.load(\"/opt/hupi/JAR/bson-3.4.1.jar\")","user":"anonymous","dateUpdated":"2019-06-17T19:46:42+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res0: org.apache.zeppelin.dep.Dependency = org.apache.zeppelin.dep.Dependency@3cecebb\n"}]},"apps":[],"jobName":"paragraph_1560776716200_-850106804","id":"20190617-130516_1404870610","dateCreated":"2019-06-17T13:05:16+0000","dateStarted":"2019-06-17T19:46:42+0000","dateFinished":"2019-06-17T19:46:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:22766"},{"text":"import com.mongodb.spark._\nimport com.mongodb.spark.sql._\nimport com.mongodb.spark.config._\nimport org.bson._\n\nimport org.apache.spark.sql.types._","user":"anonymous","dateUpdated":"2019-06-17T19:46:48+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import com.mongodb.spark._\nimport com.mongodb.spark.sql._\nimport com.mongodb.spark.config._\nimport org.bson._\nimport org.apache.spark.sql.types._\n"}]},"apps":[],"jobName":"paragraph_1560504786580_-1623450164","id":"20190614-093306_1161595589","dateCreated":"2019-06-14T09:33:06+0000","dateStarted":"2019-06-17T19:46:48+0000","dateFinished":"2019-06-17T19:46:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:22767"},{"text":"%md\n# Parameters","user":"anonymous","dateUpdated":"2019-06-17T19:46:52+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Parameters</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1560504532577_-884391892","id":"20190613-132104_1803223495","dateCreated":"2019-06-14T09:28:52+0000","dateStarted":"2019-06-17T19:46:52+0000","dateFinished":"2019-06-17T19:46:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:22768"},{"text":"val HdfsUrl = \"hdfs://hupi-factory-02-01-01.factory02.viet.cloud-torus.com:8020/\"\nval dataRepo = \"user/factory02/formation_hupi/wine.csv\"","user":"anonymous","dateUpdated":"2019-06-17T19:46:52+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"HdfsUrl: String = hdfs://hupi-factory-02-01-01.factory02.viet.cloud-torus.com:8020/\ndataRepo: String = user/factory02/formation_hupi/wine.csv\n"}]},"apps":[],"jobName":"paragraph_1560504532577_-1364766259","id":"20190613-132152_667110088","dateCreated":"2019-06-14T09:28:52+0000","dateStarted":"2019-06-17T19:46:52+0000","dateFinished":"2019-06-17T19:46:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:22769"},{"text":"val username = \"factory02\"\r\nval password = \"HUPI\"\r\nval hostname = \"10.101.2.5\"\r\n//val hostname = \"hupi-factory-02-06-01.factory02.viet.cloud-torus.com\"\r\n//val mongoUrl = s\"mongodb://$username:$password@$hostname\"\r\nval mongoUrl = s\"mongodb://$username:$password@$hostname\"\r\nval collection = \"TOR_72_wine_data\"","user":"anonymous","dateUpdated":"2019-06-17T19:46:53+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"username: String = factory02\npassword: String = HUPI\nhostname: String = 10.101.2.5\nmongoUrl: String = mongodb://factory02:HUPI@10.101.2.5\ncollection: String = TOR_72_wine_data\n"}]},"apps":[],"jobName":"paragraph_1560504800661_1054728619","id":"20190614-093320_588633918","dateCreated":"2019-06-14T09:33:20+0000","dateStarted":"2019-06-17T19:46:53+0000","dateFinished":"2019-06-17T19:46:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:22770"},{"text":"%md\n# Load data from HDFS\n\nHere, we use dataset wine.csv that contains chemical analysis of wines grown in the same region in Italy but derived from two different cultivars. This is a sample from dataset wine.data from UCI https://archive.ics.uci.edu/ml/datasets/wine","user":"anonymous","dateUpdated":"2019-06-17T19:46:53+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Load data from HDFS</h1>\n<p>Here, we use dataset wine.csv that contains chemical analysis of wines grown in the same region in Italy but derived from two different cultivars. This is a sample from dataset wine.data from UCI <a href=\"https://archive.ics.uci.edu/ml/datasets/wine\">https://archive.ics.uci.edu/ml/datasets/wine</a></p>\n</div>"}]},"apps":[],"jobName":"paragraph_1560504532578_-1398553105","id":"20190611-123710_1870998178","dateCreated":"2019-06-14T09:28:52+0000","dateStarted":"2019-06-17T19:46:53+0000","dateFinished":"2019-06-17T19:46:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:22771"},{"text":"// Load and parse the data\nval data = spark.read.format(\"csv\").option(\"header\", \"false\").load(HdfsUrl + dataRepo)\n\n// list of all columns\nval columns_original = data.columns.toSeq","user":"anonymous","dateUpdated":"2019-06-17T19:46:53+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"data: org.apache.spark.sql.DataFrame = [_c0: string, _c1: string ... 12 more fields]\ncolumns_original: Seq[String] = WrappedArray(_c0, _c1, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c10, _c11, _c12, _c13)\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=0"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1560778244703_2018013756","id":"20190617-133044_1829596580","dateCreated":"2019-06-17T13:30:44+0000","dateStarted":"2019-06-17T19:46:53+0000","dateFinished":"2019-06-17T19:46:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:22772"},{"text":"// convert all column into Double except class \nval data_modified = data\n                .withColumn(\"class\",$\"_c0\".cast(\"String\"))\n                .withColumn(\"Alcohol\",$\"_c1\".cast(\"Double\"))\n                .withColumn(\"Malic_acid\",$\"_c2\".cast(\"Double\"))\n                .withColumn(\"Ash\",$\"_c3\".cast(\"Double\"))\n                .withColumn(\"Alcalinity_ash\",$\"_c4\".cast(\"Double\"))\n                .withColumn(\"Magnesium\",$\"_c5\".cast(\"Double\"))\n                .withColumn(\"Total_phenols\",$\"_c6\".cast(\"Double\"))\n                .withColumn(\"Flavanoids\",$\"_c7\".cast(\"Double\"))\n                .withColumn(\"Nonflavanoid_phenols\",$\"_c8\".cast(\"Double\"))\n                .withColumn(\"Proanthocyanins\",$\"_c9\".cast(\"Double\"))\n                .withColumn(\"Color_intensity\",$\"_c10\".cast(\"Double\"))\n                .withColumn(\"Hue\",$\"_c11\".cast(\"Double\"))\n                .withColumn(\"OD280_OD315_diluted_wines\",$\"_c12\".cast(\"Double\"))\n                .withColumn(\"Proline\",$\"_c13\".cast(\"Double\"))\n                \n// we select only columns with good name and good type of data\nval data_final = data_modified.drop(columns_original : _*) \n                ","user":"anonymous","dateUpdated":"2019-06-17T19:49:35+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"data_modified: org.apache.spark.sql.DataFrame = [_c0: string, _c1: string ... 26 more fields]\ndata_final: org.apache.spark.sql.DataFrame = [class: string, Alcohol: double ... 12 more fields]\n"}]},"apps":[],"jobName":"paragraph_1560504532578_1169417828","id":"20190611-124117_1509176682","dateCreated":"2019-06-14T09:28:52+0000","dateStarted":"2019-06-17T19:49:35+0000","dateFinished":"2019-06-17T19:49:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:22773"},{"text":"data_final.printSchema()","user":"anonymous","dateUpdated":"2019-06-17T19:49:38+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- class: string (nullable = true)\n |-- Alcohol: double (nullable = true)\n |-- Malic_acid: double (nullable = true)\n |-- Ash: double (nullable = true)\n |-- Alcalinity_ash: double (nullable = true)\n |-- Magnesium: double (nullable = true)\n |-- Total_phenols: double (nullable = true)\n |-- Flavanoids: double (nullable = true)\n |-- Nonflavanoid_phenols: double (nullable = true)\n |-- Proanthocyanins: double (nullable = true)\n |-- Color_intensity: double (nullable = true)\n |-- Hue: double (nullable = true)\n |-- OD280_OD315_diluted_wines: double (nullable = true)\n |-- Proline: double (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1560777700196_-946189448","id":"20190617-132140_788642288","dateCreated":"2019-06-17T13:21:40+0000","dateStarted":"2019-06-17T19:49:38+0000","dateFinished":"2019-06-17T19:49:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:22774"},{"text":"z.show(data_final)","user":"anonymous","dateUpdated":"2019-06-17T19:46:57+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"class":"string","Alcohol":"string","Malic_acid":"string","Ash":"string","Alcalinity_ash":"string","Magnesium":"string","Total_phenols":"string","Flavanoids":"string","Nonflavanoid_phenols":"string","Proanthocyanins":"string","Color_intensity":"string","Hue":"string","OD280_OD315_diluted_wines":"string","Proline":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"class\tAlcohol\tMalic_acid\tAsh\tAlcalinity_ash\tMagnesium\tTotal_phenols\tFlavanoids\tNonflavanoid_phenols\tProanthocyanins\tColor_intensity\tHue\tOD280_OD315_diluted_wines\tProline\n1.0\t14.23\t1.71\t2.43\t15.6\t127.0\t2.8\t3.06\t0.28\t2.29\t5.64\t1.04\t3.92\t1065.0\n1.0\t13.2\t1.78\t2.14\t11.2\t100.0\t2.65\t2.76\t0.26\t1.28\t4.38\t1.05\t3.4\t1050.0\n1.0\t13.16\t2.36\t2.67\t18.6\t101.0\t2.8\t3.24\t0.3\t2.81\t5.68\t1.03\t3.17\t1185.0\n1.0\t14.37\t1.95\t2.5\t16.8\t113.0\t3.85\t3.49\t0.24\t2.18\t7.8\t0.86\t3.45\t1480.0\n1.0\t13.24\t2.59\t2.87\t21.0\t118.0\t2.8\t2.69\t0.39\t1.82\t4.32\t1.04\t2.93\t735.0\n1.0\t14.2\t1.76\t2.45\t15.2\t112.0\t3.27\t3.39\t0.34\t1.97\t6.75\t1.05\t2.85\t1450.0\n1.0\t14.39\t1.87\t2.45\t14.6\t96.0\t2.5\t2.52\t0.3\t1.98\t5.25\t1.02\t3.58\t1290.0\n1.0\t14.06\t2.15\t2.61\t17.6\t121.0\t2.6\t2.51\t0.31\t1.25\t5.05\t1.06\t3.58\t1295.0\n1.0\t14.83\t1.64\t2.17\t14.0\t97.0\t2.8\t2.98\t0.29\t1.98\t5.2\t1.08\t2.85\t1045.0\n1.0\t13.86\t1.35\t2.27\t16.0\t98.0\t2.98\t3.15\t0.22\t1.85\t7.22\t1.01\t3.55\t1045.0\n1.0\t14.1\t2.16\t2.3\t18.0\t105.0\t2.95\t3.32\t0.22\t2.38\t5.75\t1.25\t3.17\t1510.0\n1.0\t14.12\t1.48\t2.32\t16.8\t95.0\t2.2\t2.43\t0.26\t1.57\t5.0\t1.17\t2.82\t1280.0\n1.0\t13.75\t1.73\t2.41\t16.0\t89.0\t2.6\t2.76\t0.29\t1.81\t5.6\t1.15\t2.9\t1320.0\n1.0\t14.75\t1.73\t2.39\t11.4\t91.0\t3.1\t3.69\t0.43\t2.81\t5.4\t1.25\t2.73\t1150.0\n1.0\t14.38\t1.87\t2.38\t12.0\t102.0\t3.3\t3.64\t0.29\t2.96\t7.5\t1.2\t3.0\t1547.0\n1.0\t13.63\t1.81\t2.7\t17.2\t112.0\t2.85\t2.91\t0.3\t1.46\t7.3\t1.28\t2.88\t1310.0\n1.0\t14.3\t1.92\t2.72\t20.0\t120.0\t2.8\t3.14\t0.33\t1.97\t6.2\t1.07\t2.65\t1280.0\n1.0\t13.83\t1.57\t2.62\t20.0\t115.0\t2.95\t3.4\t0.4\t1.72\t6.6\t1.13\t2.57\t1130.0\n1.0\t14.19\t1.59\t2.48\t16.5\t108.0\t3.3\t3.93\t0.32\t1.86\t8.7\t1.23\t2.82\t1680.0\n1.0\t13.64\t3.1\t2.56\t15.2\t116.0\t2.7\t3.03\t0.17\t1.66\t5.1\t0.96\t3.36\t845.0\n1.0\t14.06\t1.63\t2.28\t16.0\t126.0\t3.0\t3.17\t0.24\t2.1\t5.65\t1.09\t3.71\t780.0\n1.0\t12.93\t3.8\t2.65\t18.6\t102.0\t2.41\t2.41\t0.25\t1.98\t4.5\t1.03\t3.52\t770.0\n1.0\t13.71\t1.86\t2.36\t16.6\t101.0\t2.61\t2.88\t0.27\t1.69\t3.8\t1.11\t4.0\t1035.0\n1.0\t12.85\t1.6\t2.52\t17.8\t95.0\t2.48\t2.37\t0.26\t1.46\t3.93\t1.09\t3.63\t1015.0\n1.0\t13.5\t1.81\t2.61\t20.0\t96.0\t2.53\t2.61\t0.28\t1.66\t3.52\t1.12\t3.82\t845.0\n1.0\t13.05\t2.05\t3.22\t25.0\t124.0\t2.63\t2.68\t0.47\t1.92\t3.58\t1.13\t3.2\t830.0\n1.0\t13.39\t1.77\t2.62\t16.1\t93.0\t2.85\t2.94\t0.34\t1.45\t4.8\t0.92\t3.22\t1195.0\n1.0\t13.3\t1.72\t2.14\t17.0\t94.0\t2.4\t2.19\t0.27\t1.35\t3.95\t1.02\t2.77\t1285.0\n1.0\t13.87\t1.9\t2.8\t19.4\t107.0\t2.95\t2.97\t0.37\t1.76\t4.5\t1.25\t3.4\t915.0\n1.0\t14.02\t1.68\t2.21\t16.0\t96.0\t2.65\t2.33\t0.26\t1.98\t4.7\t1.04\t3.59\t1035.0\n1.0\t13.73\t1.5\t2.7\t22.5\t101.0\t3.0\t3.25\t0.29\t2.38\t5.7\t1.19\t2.71\t1285.0\n1.0\t13.58\t1.66\t2.36\t19.1\t106.0\t2.86\t3.19\t0.22\t1.95\t6.9\t1.09\t2.88\t1515.0\n1.0\t13.68\t1.83\t2.36\t17.2\t104.0\t2.42\t2.69\t0.42\t1.97\t3.84\t1.23\t2.87\t990.0\n1.0\t13.76\t1.53\t2.7\t19.5\t132.0\t2.95\t2.74\t0.5\t1.35\t5.4\t1.25\t3.0\t1235.0\n1.0\t13.51\t1.8\t2.65\t19.0\t110.0\t2.35\t2.53\t0.29\t1.54\t4.2\t1.1\t2.87\t1095.0\n1.0\t13.48\t1.81\t2.41\t20.5\t100.0\t2.7\t2.98\t0.26\t1.86\t5.1\t1.04\t3.47\t920.0\n1.0\t13.28\t1.64\t2.84\t15.5\t110.0\t2.6\t2.68\t0.34\t1.36\t4.6\t1.09\t2.78\t880.0\n1.0\t13.05\t1.65\t2.55\t18.0\t98.0\t2.45\t2.43\t0.29\t1.44\t4.25\t1.12\t2.51\t1105.0\n1.0\t13.07\t1.5\t2.1\t15.5\t98.0\t2.4\t2.64\t0.28\t1.37\t3.7\t1.18\t2.69\t1020.0\n1.0\t14.22\t3.99\t2.51\t13.2\t128.0\t3.0\t3.04\t0.2\t2.08\t5.1\t0.89\t3.53\t760.0\n1.0\t13.56\t1.71\t2.31\t16.2\t117.0\t3.15\t3.29\t0.34\t2.34\t6.13\t0.95\t3.38\t795.0\n1.0\t13.41\t3.84\t2.12\t18.8\t90.0\t2.45\t2.68\t0.27\t1.48\t4.28\t0.91\t3.0\t1035.0\n1.0\t13.88\t1.89\t2.59\t15.0\t101.0\t3.25\t3.56\t0.17\t1.7\t5.43\t0.88\t3.56\t1095.0\n1.0\t13.24\t3.98\t2.29\t17.5\t103.0\t2.64\t2.63\t0.32\t1.66\t4.36\t0.82\t3.0\t680.0\n1.0\t13.05\t1.77\t2.1\t17.0\t107.0\t3.0\t3.0\t0.28\t2.03\t5.04\t0.88\t3.35\t885.0\n1.0\t14.21\t4.04\t2.44\t18.9\t111.0\t2.85\t2.65\t0.3\t1.25\t5.24\t0.87\t3.33\t1080.0\n1.0\t14.38\t3.59\t2.28\t16.0\t102.0\t3.25\t3.17\t0.27\t2.19\t4.9\t1.04\t3.44\t1065.0\n1.0\t13.9\t1.68\t2.12\t16.0\t101.0\t3.1\t3.39\t0.21\t2.14\t6.1\t0.91\t3.33\t985.0\n1.0\t14.1\t2.02\t2.4\t18.8\t103.0\t2.75\t2.92\t0.32\t2.38\t6.2\t1.07\t2.75\t1060.0\n1.0\t13.94\t1.73\t2.27\t17.4\t108.0\t2.88\t3.54\t0.32\t2.08\t8.9\t1.12\t3.1\t1260.0\n1.0\t13.05\t1.73\t2.04\t12.4\t92.0\t2.72\t3.27\t0.17\t2.91\t7.2\t1.12\t2.91\t1150.0\n1.0\t13.83\t1.65\t2.6\t17.2\t94.0\t2.45\t2.99\t0.22\t2.29\t5.6\t1.24\t3.37\t1265.0\n1.0\t13.82\t1.75\t2.42\t14.0\t111.0\t3.88\t3.74\t0.32\t1.87\t7.05\t1.01\t3.26\t1190.0\n1.0\t13.77\t1.9\t2.68\t17.1\t115.0\t3.0\t2.79\t0.39\t1.68\t6.3\t1.13\t2.93\t1375.0\n1.0\t13.74\t1.67\t2.25\t16.4\t118.0\t2.6\t2.9\t0.21\t1.62\t5.85\t0.92\t3.2\t1060.0\n1.0\t13.56\t1.73\t2.46\t20.5\t116.0\t2.96\t2.78\t0.2\t2.45\t6.25\t0.98\t3.03\t1120.0\n1.0\t14.22\t1.7\t2.3\t16.3\t118.0\t3.2\t3.0\t0.26\t2.03\t6.38\t0.94\t3.31\t970.0\n1.0\t13.29\t1.97\t2.68\t16.8\t102.0\t3.0\t3.23\t0.31\t1.66\t6.0\t1.07\t2.84\t1270.0\n1.0\t13.72\t1.43\t2.5\t16.7\t108.0\t3.4\t3.67\t0.19\t2.04\t6.8\t0.89\t2.87\t1285.0\n2.0\t12.37\t0.94\t1.36\t10.6\t88.0\t1.98\t0.57\t0.28\t0.42\t1.95\t1.05\t1.82\t520.0\n2.0\t12.33\t1.1\t2.28\t16.0\t101.0\t2.05\t1.09\t0.63\t0.41\t3.27\t1.25\t1.67\t680.0\n2.0\t12.64\t1.36\t2.02\t16.8\t100.0\t2.02\t1.41\t0.53\t0.62\t5.75\t0.98\t1.59\t450.0\n2.0\t13.67\t1.25\t1.92\t18.0\t94.0\t2.1\t1.79\t0.32\t0.73\t3.8\t1.23\t2.46\t630.0\n2.0\t12.37\t1.13\t2.16\t19.0\t87.0\t3.5\t3.1\t0.19\t1.87\t4.45\t1.22\t2.87\t420.0\n2.0\t12.17\t1.45\t2.53\t19.0\t104.0\t1.89\t1.75\t0.45\t1.03\t2.95\t1.45\t2.23\t355.0\n2.0\t12.37\t1.21\t2.56\t18.1\t98.0\t2.42\t2.65\t0.37\t2.08\t4.6\t1.19\t2.3\t678.0\n2.0\t13.11\t1.01\t1.7\t15.0\t78.0\t2.98\t3.18\t0.26\t2.28\t5.3\t1.12\t3.18\t502.0\n2.0\t12.37\t1.17\t1.92\t19.6\t78.0\t2.11\t2.0\t0.27\t1.04\t4.68\t1.12\t3.48\t510.0\n2.0\t13.34\t0.94\t2.36\t17.0\t110.0\t2.53\t1.3\t0.55\t0.42\t3.17\t1.02\t1.93\t750.0\n2.0\t12.21\t1.19\t1.75\t16.8\t151.0\t1.85\t1.28\t0.14\t2.5\t2.85\t1.28\t3.07\t718.0\n2.0\t12.29\t1.61\t2.21\t20.4\t103.0\t1.1\t1.02\t0.37\t1.46\t3.05\t0.906\t1.82\t870.0\n2.0\t13.86\t1.51\t2.67\t25.0\t86.0\t2.95\t2.86\t0.21\t1.87\t3.38\t1.36\t3.16\t410.0\n2.0\t13.49\t1.66\t2.24\t24.0\t87.0\t1.88\t1.84\t0.27\t1.03\t3.74\t0.98\t2.78\t472.0\n2.0\t12.99\t1.67\t2.6\t30.0\t139.0\t3.3\t2.89\t0.21\t1.96\t3.35\t1.31\t3.5\t985.0\n2.0\t11.96\t1.09\t2.3\t21.0\t101.0\t3.38\t2.14\t0.13\t1.65\t3.21\t0.99\t3.13\t886.0\n2.0\t11.66\t1.88\t1.92\t16.0\t97.0\t1.61\t1.57\t0.34\t1.15\t3.8\t1.23\t2.14\t428.0\n2.0\t13.03\t0.9\t1.71\t16.0\t86.0\t1.95\t2.03\t0.24\t1.46\t4.6\t1.19\t2.48\t392.0\n2.0\t11.84\t2.89\t2.23\t18.0\t112.0\t1.72\t1.32\t0.43\t0.95\t2.65\t0.96\t2.52\t500.0\n2.0\t12.33\t0.99\t1.95\t14.8\t136.0\t1.9\t1.85\t0.35\t2.76\t3.4\t1.06\t2.31\t750.0\n2.0\t12.7\t3.87\t2.4\t23.0\t101.0\t2.83\t2.55\t0.43\t1.95\t2.57\t1.19\t3.13\t463.0\n2.0\t12.0\t0.92\t2.0\t19.0\t86.0\t2.42\t2.26\t0.3\t1.43\t2.5\t1.38\t3.12\t278.0\n2.0\t12.72\t1.81\t2.2\t18.8\t86.0\t2.2\t2.53\t0.26\t1.77\t3.9\t1.16\t3.14\t714.0\n2.0\t12.08\t1.13\t2.51\t24.0\t78.0\t2.0\t1.58\t0.4\t1.4\t2.2\t1.31\t2.72\t630.0\n2.0\t13.05\t3.86\t2.32\t22.5\t85.0\t1.65\t1.59\t0.61\t1.62\t4.8\t0.84\t2.01\t515.0\n2.0\t11.84\t0.89\t2.58\t18.0\t94.0\t2.2\t2.21\t0.22\t2.35\t3.05\t0.79\t3.08\t520.0\n2.0\t12.67\t0.98\t2.24\t18.0\t99.0\t2.2\t1.94\t0.3\t1.46\t2.62\t1.23\t3.16\t450.0\n2.0\t12.16\t1.61\t2.31\t22.8\t90.0\t1.78\t1.69\t0.43\t1.56\t2.45\t1.33\t2.26\t495.0\n2.0\t11.65\t1.67\t2.62\t26.0\t88.0\t1.92\t1.61\t0.4\t1.34\t2.6\t1.36\t3.21\t562.0\n2.0\t11.64\t2.06\t2.46\t21.6\t84.0\t1.95\t1.69\t0.48\t1.35\t2.8\t1.0\t2.75\t680.0\n2.0\t12.08\t1.33\t2.3\t23.6\t70.0\t2.2\t1.59\t0.42\t1.38\t1.74\t1.07\t3.21\t625.0\n2.0\t12.08\t1.83\t2.32\t18.5\t81.0\t1.6\t1.5\t0.52\t1.64\t2.4\t1.08\t2.27\t480.0\n2.0\t12.0\t1.51\t2.42\t22.0\t86.0\t1.45\t1.25\t0.5\t1.63\t3.6\t1.05\t2.65\t450.0\n2.0\t12.69\t1.53\t2.26\t20.7\t80.0\t1.38\t1.46\t0.58\t1.62\t3.05\t0.96\t2.06\t495.0\n2.0\t12.29\t2.83\t2.22\t18.0\t88.0\t2.45\t2.25\t0.25\t1.99\t2.15\t1.15\t3.3\t290.0\n2.0\t11.62\t1.99\t2.28\t18.0\t98.0\t3.02\t2.26\t0.17\t1.35\t3.25\t1.16\t2.96\t345.0\n2.0\t12.47\t1.52\t2.2\t19.0\t162.0\t2.5\t2.27\t0.32\t3.28\t2.6\t1.16\t2.63\t937.0\n2.0\t11.81\t2.12\t2.74\t21.5\t134.0\t1.6\t0.99\t0.14\t1.56\t2.5\t0.95\t2.26\t625.0\n2.0\t12.29\t1.41\t1.98\t16.0\t85.0\t2.55\t2.5\t0.29\t1.77\t2.9\t1.23\t2.74\t428.0\n2.0\t12.37\t1.07\t2.1\t18.5\t88.0\t3.52\t3.75\t0.24\t1.95\t4.5\t1.04\t2.77\t660.0\n2.0\t12.29\t3.17\t2.21\t18.0\t88.0\t2.85\t2.99\t0.45\t2.81\t2.3\t1.42\t2.83\t406.0\n2.0\t12.08\t2.08\t1.7\t17.5\t97.0\t2.23\t2.17\t0.26\t1.4\t3.3\t1.27\t2.96\t710.0\n2.0\t12.6\t1.34\t1.9\t18.5\t88.0\t1.45\t1.36\t0.29\t1.35\t2.45\t1.04\t2.77\t562.0\n2.0\t12.34\t2.45\t2.46\t21.0\t98.0\t2.56\t2.11\t0.34\t1.31\t2.8\t0.8\t3.38\t438.0\n2.0\t11.82\t1.72\t1.88\t19.5\t86.0\t2.5\t1.64\t0.37\t1.42\t2.06\t0.94\t2.44\t415.0\n2.0\t12.51\t1.73\t1.98\t20.5\t85.0\t2.2\t1.92\t0.32\t1.48\t2.94\t1.04\t3.57\t672.0\n2.0\t12.42\t2.55\t2.27\t22.0\t90.0\t1.68\t1.84\t0.66\t1.42\t2.7\t0.86\t3.3\t315.0\n2.0\t12.25\t1.73\t2.12\t19.0\t80.0\t1.65\t2.03\t0.37\t1.63\t3.4\t1.0\t3.17\t510.0\n2.0\t12.72\t1.75\t2.28\t22.5\t84.0\t1.38\t1.76\t0.48\t1.63\t3.3\t0.88\t2.42\t488.0\n2.0\t12.22\t1.29\t1.94\t19.0\t92.0\t2.36\t2.04\t0.39\t2.08\t2.7\t0.86\t3.02\t312.0\n2.0\t11.61\t1.35\t2.7\t20.0\t94.0\t2.74\t2.92\t0.29\t2.49\t2.65\t0.96\t3.26\t680.0\n2.0\t11.46\t3.74\t1.82\t19.5\t107.0\t3.18\t2.58\t0.24\t3.58\t2.9\t0.75\t2.81\t562.0\n2.0\t12.52\t2.43\t2.17\t21.0\t88.0\t2.55\t2.27\t0.26\t1.22\t2.0\t0.9\t2.78\t325.0\n2.0\t11.76\t2.68\t2.92\t20.0\t103.0\t1.75\t2.03\t0.6\t1.05\t3.8\t1.23\t2.5\t607.0\n2.0\t11.41\t0.74\t2.5\t21.0\t88.0\t2.48\t2.01\t0.42\t1.44\t3.08\t1.1\t2.31\t434.0\n2.0\t12.08\t1.39\t2.5\t22.5\t84.0\t2.56\t2.29\t0.43\t1.04\t2.9\t0.93\t3.19\t385.0\n2.0\t11.03\t1.51\t2.2\t21.5\t85.0\t2.46\t2.17\t0.52\t2.01\t1.9\t1.71\t2.87\t407.0\n2.0\t11.82\t1.47\t1.99\t20.8\t86.0\t1.98\t1.6\t0.3\t1.53\t1.95\t0.95\t3.33\t495.0\n2.0\t12.42\t1.61\t2.19\t22.5\t108.0\t2.0\t2.09\t0.34\t1.61\t2.06\t1.06\t2.96\t345.0\n2.0\t12.77\t3.43\t1.98\t16.0\t80.0\t1.63\t1.25\t0.43\t0.83\t3.4\t0.7\t2.12\t372.0\n2.0\t12.0\t3.43\t2.0\t19.0\t87.0\t2.0\t1.64\t0.37\t1.87\t1.28\t0.93\t3.05\t564.0\n2.0\t11.45\t2.4\t2.42\t20.0\t96.0\t2.9\t2.79\t0.32\t1.83\t3.25\t0.8\t3.39\t625.0\n2.0\t11.56\t2.05\t3.23\t28.5\t119.0\t3.18\t5.08\t0.47\t1.87\t6.0\t0.93\t3.69\t465.0\n2.0\t12.42\t4.43\t2.73\t26.5\t102.0\t2.2\t2.13\t0.43\t1.71\t2.08\t0.92\t3.12\t365.0\n2.0\t13.05\t5.8\t2.13\t21.5\t86.0\t2.62\t2.65\t0.3\t2.01\t2.6\t0.73\t3.1\t380.0\n2.0\t11.87\t4.31\t2.39\t21.0\t82.0\t2.86\t3.03\t0.21\t2.91\t2.8\t0.75\t3.64\t380.0\n2.0\t12.07\t2.16\t2.17\t21.0\t85.0\t2.6\t2.65\t0.37\t1.35\t2.76\t0.86\t3.28\t378.0\n2.0\t12.43\t1.53\t2.29\t21.5\t86.0\t2.74\t3.15\t0.39\t1.77\t3.94\t0.69\t2.84\t352.0\n2.0\t11.79\t2.13\t2.78\t28.5\t92.0\t2.13\t2.24\t0.58\t1.76\t3.0\t0.97\t2.44\t466.0\n2.0\t12.37\t1.63\t2.3\t24.5\t88.0\t2.22\t2.45\t0.4\t1.9\t2.12\t0.89\t2.78\t342.0\n2.0\t12.04\t4.3\t2.38\t22.0\t80.0\t2.1\t1.75\t0.42\t1.35\t2.6\t0.79\t2.57\t580.0\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=1"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1560777935060_-1193218771","id":"20190617-132535_1456590270","dateCreated":"2019-06-17T13:25:35+0000","dateStarted":"2019-06-17T19:46:57+0000","dateFinished":"2019-06-17T19:46:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:22775"},{"text":"data_final.count()","user":"anonymous","dateUpdated":"2019-06-17T19:46:58+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res3: Long = 130\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=2"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1560504532579_-537615506","id":"20190612-074817_885713612","dateCreated":"2019-06-14T09:28:52+0000","dateStarted":"2019-06-17T19:46:58+0000","dateFinished":"2019-06-17T19:46:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:22776"},{"text":"%md\n# Write data to MongoDB","user":"anonymous","dateUpdated":"2019-06-17T19:46:59+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Write data to MongoDB</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1560504532579_1441506804","id":"20190611-124400_1072583055","dateCreated":"2019-06-14T09:28:52+0000","dateStarted":"2019-06-17T19:46:59+0000","dateFinished":"2019-06-17T19:46:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:22777"},{"text":"data_final.write\r\n    .format(\"com.mongodb.spark.sql\")\r\n    .option(\"uri\", s\"$mongoUrl/$username.$collection\")\r\n    .mode(\"overwrite\") // à mettre append après\r\n    .save()  ","user":"anonymous","dateUpdated":"2019-06-17T19:49:47+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=4"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1560504532583_1353679958","id":"20190613-133936_388514160","dateCreated":"2019-06-14T09:28:52+0000","dateStarted":"2019-06-17T19:49:47+0000","dateFinished":"2019-06-17T19:49:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:22778"},{"user":"anonymous","dateUpdated":"2019-06-17T19:47:00+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560778675767_1848763648","id":"20190617-133755_1861173022","dateCreated":"2019-06-17T13:37:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:22779"}],"name":"MONTUS/Formation - 4 Write data to MongoDB","id":"2EEZPNKBV","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}